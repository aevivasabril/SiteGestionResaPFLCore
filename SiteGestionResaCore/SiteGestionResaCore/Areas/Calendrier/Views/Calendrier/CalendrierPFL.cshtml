<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
      integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

@model CalenViewModel

@{
    ViewData["Title"] = "CalendrierPFL";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<br />
<h1 class="text-center">Calendrier PFL</h1>
<br />

<!--https://www.w3.org/WAI/tutorials/tables/irregular/ Pour faire une table avec ce format-->
<div class="row">
    <h5 class="text-center">Selectionnez une date de debut et de fin pour affichage du calendrier </h5>
    <div class="container">
        <form asp-action="AfficherPlanningDuAu" asp-controller="Calendrier" asp-area="Calendrier" method="post">
            <div class="form-group row justify-content-center">
                <br />
                <div class="col-sm-4 col-md-4 col-lg-4">
                    <!--Date picker -->
                    <div class="form-group">
                        @Html.Label("Du : ")
                        <input class="form-control" name="DateDu" asp-for="@Model.DateDu" type="date" />
                        @Html.ValidationMessageFor(m => m.DateDu, "", new { @class = "text-danger" })
                        <!--<input type="text" class="form-control" id="datepickerdebut" placeholder="MM/DD/YYYY">-->
                    </div>
                </div>
                <div class="col-sm-4 col-md-4 col-lg-4">
                    <!--Date picker -->
                    <div class="form-group">
                        @Html.Label("Au : ")
                        <input class="form-control" name="DateAu" asp-for="@Model.DateAu" type="date" />
                        @Html.ValidationMessageFor(m => m.DateAu, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="col-sm-4 col-md-4 col-lg-4">
                    <input type="submit" class="btn btn-outline-success" value="Afficher Planning" />
                </div>
            </div>
        </form>       
    </div>
</div>
<hr />
<br />
<div class="row">
    <table class="table table-bordered table-responsive">
        <colgroup span="2"></colgroup>
        <colgroup span="2"></colgroup>
        <tr class="text-center">
            <td rowspan="2">Zones</td>
            @for (int z = 0; z < Model.JoursCalendrier.Count(); z++)
            {
                <th colspan="2" scope="colgroup">@Model.JoursCalendrier[z].NomJour - @Model.JoursCalendrier[z].JourPourAffichage.ToShortDateString()</th>
            }
        </tr>
        <tr>
            @for (int z = 0; z < Model.JoursCalendrier.Count(); z++)
            {
                <th scope="col">Matin</th>
                <th scope="col">Aprèm</th>
            }
        </tr>
        <!-- Normalement 17 zones -->
        @for (int j = 0; j < Model.ListResasZone.Count(); j++)
        {
            <tr>
                <th scope="row">
                    @Model.ListResasZone[j].NomZone
                    <span class="fas fa-caret-down" onclick="showEquipements(@Model.ListResasZone[j].IdZone.ToString())"></span>
                </th>
                @for(int i = 0; i < Model.ListResasZone[j].ListeDispoZonesDuAu.Count(); i++)
                {
                    @if(Model.ListResasZone[j].ListeDispoZonesDuAu[i].IsZoneOccupeMatin == true)
                    {
                        <td style="color:darkviolet">                         
                            <strong>Occupée</strong>
                        </td>
                    }
                    else
                    {
                        <td style="color:green">                         
                            <strong>Disponible</strong>
                        </td>
                    }
                    @if(Model.ListResasZone[j].ListeDispoZonesDuAu[i].IsZoneOccupeAprem == true)
                    {
                        <td style="color:darkviolet">                         
                            <strong>Occupée</strong>
                        </td>
                    }
                    else
                    {
                        <td style="color:green">                         
                            <strong>Disponible</strong>
                        </td>
                    }
                }
            </tr>
            @for (int y = 0; y < Model.ListResasZone[j].ListEquipementVsResa.Count(); y++)
            {
                <tr class="hide" style="display:none" name="@Model.ListResasZone[j].IdZone.ToString()" id="@y">
                    <th style="color:gray">@Model.ListResasZone[j].ListEquipementVsResa[y].NomEquipement</th>
                    @for(int x = 0; x < Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu.Count(); x++)
                    {
                        <td style="background-color:@Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].CouleurMatin">
                            @if(@Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasMatin.Count() == 0)
                            {
                                <a><strong>Libre Matin</strong></a>
                            }
                            else
                            {
                                @for(int z = 0; z < Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasMatin.Count(); z++)
                                {
                                    if(Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasMatin[z].Confidentialite == "Confidentiel")
                                    {
                                        <strong>Confidentiel</strong>
                                    }
                                    else
                                    {
                                        <a><strong>[Reservé] <strong>@Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasMatin[z].IdEssai</strong>]- 
                                        (@Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasMatin[z].Confidentialite)</strong></a>
                                    }                                                    
                                }
                            }
                        </td>

                        <td style="background-color:@Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].CouleurAprem">
                            @if (@Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasAprem.Count() == 0)
                            {
                                <a><strong>Libre Aprem</strong></a>
                            }
                            else
                            {
                                @for (int z = 0; z < Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasAprem.Count(); z++)
                                {
                                    if (Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasAprem[z].Confidentialite == "Confidentiel")
                                    {
                                        <strong>Confidentiel</strong>
                                    }
                                    else
                                    {
                                        <a>
                                            <strong>
                                                [Reservé] <strong>@Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasAprem[z].IdEssai</strong>]-
                                                (@Model.ListResasZone[j].ListEquipementVsResa[y].ListResasDuAu[x].ListResasAprem[z].Confidentialite)
                                            </strong>
                                        </a>
                                    }
                                    
                                }
                            }
                        </td>
                    }
                </tr>
            }
        }
    </table>
</div>

<!--CODE SNIPPET:
<table>
    <col>
    <colgroup span="2"></colgroup>
    <colgroup span="2"></colgroup>
    <tr>
        <td rowspan="2"></td>
        <th colspan="2" scope="colgroup">Mars</th>
        <th colspan="2" scope="colgroup">Venus</th>
    </tr>
    <tr>
        <th scope="col">Produced</th>
        <th scope="col">Sold</th>
        <th scope="col">Produced</th>
        <th scope="col">Sold</th>
    </tr>
    <tr>
        <th scope="row">Teddy Bears</th>
        <td>50,000</td>
        <td>30,000</td>
        <td>100,000</td>
        <td>80,000</td>
    </tr>
    <tr>
        <th scope="row">Board Games</th>
        <td>10,000</td>
        <td>5,000</td>
        <td>12,000</td>
        <td>9,000</td>
    </tr>
</table>-->
@section Scripts
{
    <!-- JS includes -->
    <script type="text/javascript">
        function showEquipements(parameter) {
            var divName = document.getElementsByName(parameter);
            var i;
            for (i = 0; i < divName.length; i++) {
                var ele = divName[i];
                if (ele.style.display == "") {
                    ele.style.display = "none";
                } else {
                    ele.style.display = "";
                }
            }         
        }
    </script>
}